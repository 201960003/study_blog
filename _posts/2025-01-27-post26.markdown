---
layout: post
title:  Web Speech APIë¡œ TTS ë° STT êµ¬í˜„í•˜ê¸°
date:   2025-01-27 +0900
categories: [HTML, Javascript]
---

{% include file/post26/tts-stt.html %}

<hr>

## TTS ì½”ë“œ

### html
```html
<div class="container">
    <h2>Speech-to-Text (STT)</h2>
    <p id="status-message">ë§ˆì´í¬ ê¶Œí•œ ìƒíƒœ:
        <span id="permission-status">í™•ì¸ ì¤‘...</span>
    </p>
    <button id="start-record-button">ë…¹ìŒ ì‹œì‘</button>
    <button id="stop-record-button" disabled>ë…¹ìŒ ì¤‘ì§€</button>
    <p>ì¸ì‹ëœ í…ìŠ¤íŠ¸: <span id="recognized-text"></span></p>
</div>

```


```javascript
    const speakButton = document.getElementById('speak-button');
    const pauseButton = document.getElementById('pause-button');
    const resumeButton = document.getElementById('resume-button');
    const stopButton = document.getElementById('stop-button');
    const ttsText = document.getElementById('tts-text');

    let currentSpeech = null; // í˜„ì¬ ì§„í–‰ ì¤‘ì¸ SpeechSynthesisUtterance ê°ì²´

    // TTS ì‹œì‘
    speakButton.addEventListener('click', () => {
        const text = ttsText.value.trim();
        if (!text) {
            alert("ì½ì„ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
            return;
        }

        // í˜„ì¬ ì§„í–‰ ì¤‘ì¸ TTSê°€ ìˆë‹¤ë©´ ì¤‘ì§€
        if (window.speechSynthesis.speaking || window.speechSynthesis.paused) {
            window.speechSynthesis.cancel();
        }

        // ìƒˆë¡œìš´ TTS ì‹œì‘
        currentSpeech = new SpeechSynthesisUtterance(text);
        currentSpeech.lang = 'ko-KR'; // í•œêµ­ì–´ ì„¤ì •
        currentSpeech.lang = 'ko-KR'; // í•œêµ­ì–´ ì„¤ì •
        currentSpeech.rate = 1; // ìŒì„± ì†ë„, 0.1 ~ 10 ì‚¬ì´ì˜ ê°’
        currentSpeech.pitch = 1; // ìŒë†’ì´, 0 ~ 2 ì‚¬ì´ì˜ ê°’
        currentSpeech.volume = 1; // ìŒëŸ‰, 0 ~ 1 ì‚¬ì´ì˜ ê°’


        // TTSê°€ ëë‚  ë•Œ ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”
        currentSpeech.onend = () => {
            speakButton.disabled = false;
            pauseButton.disabled = true;
            resumeButton.disabled = true;
            stopButton.disabled = true;
        };

        window.speechSynthesis.speak(currentSpeech);

        // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        speakButton.disabled = true;
        pauseButton.disabled = false;
        resumeButton.disabled = true;
        stopButton.disabled = false;
    });

    // TTS ì¼ì‹œ ì¤‘ì§€
    pauseButton.addEventListener('click', () => {
        if (window.speechSynthesis.speaking) {
            window.speechSynthesis.pause();
            pauseButton.disabled = true;
            resumeButton.disabled = false;
        }
    });

    // TTS ë‹¤ì‹œ ì¬ìƒ
    resumeButton.addEventListener('click', () => {
        if (window.speechSynthesis.paused) {
            window.speechSynthesis.resume();
            pauseButton.disabled = false;
            resumeButton.disabled = true;
        }
    });

    // TTS ì¤‘ì§€
    stopButton.addEventListener('click', () => {
        if (window.speechSynthesis.speaking || window.speechSynthesis.paused) {
            window.speechSynthesis.cancel();
            speakButton.disabled = false;
            pauseButton.disabled = true;
            resumeButton.disabled = true;
            stopButton.disabled = true;
        }
    });
```


## STT ì½”ë“œ

### html
```html
<div class="container">
    <h2>Text-to-Speech (TTS)</h2>
    <textarea id="tts-text" rows="3" cols="50" placeholder="ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea><br>
    <button id="speak-button">ì½ê¸°</button>
    <button id="pause-button" disabled>ì¼ì‹œ ì¤‘ì§€</button>
    <button id="resume-button" disabled>ë‹¤ì‹œ ì¬ìƒ</button>
    <button id="stop-button" disabled>ì¤‘ì§€</button>
</div>
```

ë¨¼ì € <code>textarea</code> íƒœê·¸ì— TTS ë¥¼ ì ìš©ì‹œí‚¬ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥ ë°›ì„ ì¤€ë¹„ë¥¼ í•©ë‹ˆë‹¤.
<code>button</code> ì„ ëˆŒëŸ¬ ì…ë ¥í•œ í…ìŠ¤íŠ¸ë¥¼ ì¬ìƒì‹œí‚¤ìœ„í•œ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.


```javascript
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'ko-KR'; // í•œêµ­ì–´ ì„¤ì •
    recognition.continuous = true; // ì—°ì† ëª¨ë“œ í™œì„±í™”
    recognition.interimResults = false; // ì¤‘ê°„ ê²°ê³¼ ë¹„í™œì„±í™”


    const startButtonRec = document.getElementById('start-record-button');
    const stopButtonRec = document.getElementById('stop-record-button');
    const recognizedText = document.getElementById('recognized-text');
    const permissionStatusSpan = document.getElementById('permission-status');


    startButtonRec.addEventListener('click', () => {
        recognition.start();
        startButtonRec.disabled = true;
        stopButtonRec.disabled = false;
    });

    stopButtonRec.addEventListener('click', () => {
        recognition.stop();
        startButtonRec.disabled = false;
        stopButtonRec.disabled = true;
    });

    recognition.addEventListener('result', (event) => {
        const transcript = event.results[0][0].transcript; // ì¸ì‹ëœ í…ìŠ¤íŠ¸
        recognizedText.textContent = transcript;
    });

    recognition.addEventListener('end', () => {
        currentSpeech = new SpeechSynthesisUtterance(recognizedText.textContent);
        window.speechSynthesis.speak(currentSpeech);
        setTimeout(()=>{
            recognizedText.textContent = '';
        }, 1000); // 1ì´ˆ í›„ì— ë¹ˆ í…ìŠ¤íŠ¸ë¡œ ì—…ë°ì´íŠ¸
    });

    // ë§ˆì´í¬ ê¶Œí•œ í™•ì¸ ë° ìƒíƒœ ì—…ë°ì´íŠ¸
    async function checkMicrophonePermission() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            if (stream) {
                updateUI('granted');
            }
        } catch (error) {
            updateUI('denied');
        }
    }

    // UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateUI(status) {
        if (status === 'granted') {
            permissionStatusSpan.textContent = 'í—ˆìš©ë¨';
            permissionStatusSpan.style.color = 'green';
            startButtonRec.disabled = false;
            stopButtonRec.disabled = true;
        } else if (status === 'denied') {
            permissionStatusSpan.textContent = 'ê±°ë¶€ë¨';
            permissionStatusSpan.style.color = 'red';
            startButtonRec.disabled = true;
            stopButtonRec.disabled = true;
        } else {
            permissionStatusSpan.textContent = 'ì•Œ ìˆ˜ ì—†ìŒ';
            permissionStatusSpan.style.color = 'orange';
            startButtonRec.disabled = true;
            stopButtonRec.disabled = true;
        }
    }

    // ê¶Œí•œ ë³€ê²½ ê°ì§€
    async function monitorPermissionChanges() {
        try {
            const permissionStatus = await navigator.permissions.query({ name: 'microphone' });
            updateUI(permissionStatus.state); // ì´ˆê¸° ìƒíƒœ ì„¤ì •

            // ê¶Œí•œ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            permissionStatus.onchange = () => {
                updateUI(permissionStatus.state);
            };
        } catch (error) {
            console.error('ê¶Œí•œ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', error);
            updateUI('unknown');
        }
    }

    // ìœˆë„ìš° ë¡œë“œ ì‹œ ì‹¤í–‰
    window.addEventListener('load', () => {
        checkMicrophonePermission(); // ê¶Œí•œ ì´ˆê¸° í™•ì¸
        monitorPermissionChanges(); // ê¶Œí•œ ë³€ê²½ ê°ì§€
    });
```

ë§ˆì´í¬ ê¶Œí•œì„ í—ˆìš©í• ë•Œë§Œ STTê°€ ì‹¤í–‰ë˜ê²Œ í•©ë‹ˆë‹¤.

<br><br>

### ğŸ§ ì˜¤ëŠ˜ì˜ ì†Œê°ì€?
í”ŒëŸ¬í„°ì—ì„œ íŒ¨í‚¤ì§€ë¡œ ë°›ì•„ì„œ ì‚¬ìš©í–ˆë˜ ê²ƒì²˜ëŸ¼ node.js ì—ì„œ íŒ¨í‚¤ì§€ ë°›ì•„ì„œ ì‚¬ìš©í•˜ëŠ” ì¤„ ì•Œì•˜ëŠ”ë° Web Speech APIê°€ ìˆì–´ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë‚´ì—ì„œ í•´ê²°ì„ í•  ìˆ˜ ìˆì–´ì„œ ì‹ ê¸°í–ˆìŠµë‹ˆë‹¤.
ë¬¼ë¡  ë„¤ì´ë²„ í´ë¡œë°”ì²˜ëŸ¼ ìì—°ìŠ¤ëŸ¬ìš´ ë§íˆ¬ëŠ” ì•„ë‹ˆì§€ë§Œ ë‚˜ë¦„ ë§Œì¡±í•˜ë©´ì„œ ê¸°ëŠ¥êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.


<br>