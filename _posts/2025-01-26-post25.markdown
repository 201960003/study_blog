---
layout: post
title:  âŒœHTMLâŒŸ ìŠ¤í‹°ì»¤ ì¶”ê°€ ë° ê·¸ë¦¼ ê·¸ë¦¬ê¸° ê¸°ëŠ¥
date:   2025-01-26 +0900
categories: HTML
---
<style>
    #drawing-canvas {
        border: 1px solid black;
        background-color: white;
        display: block;
        /* margin: 20px auto; */
    }

     /*  color-picker  */
    .color-picker {
        display: flex;
        margin-bottom: 10px;
    }

    .color-button {
        position: relative;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        margin: 5px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .color-button span {
        display: none;
        color: white;
        font-size: 20px;
    }

    .color-button.selected span {
        display: block;
    }

    .black { background-color: black; color: white; }
    .red { background-color: red; }
    .orange { background-color: orange; }
    .yellow { background-color: yellow; }
    .green { background-color: green; }
    .blue { background-color: blue; }
    .indigo { background-color: indigo; }
    .violet { background-color: violet; }


    .sticker-container {
        width: 50%;
        height: 30%
    }

    .sticker {
        width: 100px;
        height: 100px;
    }
</style>
<div class="canvas-container">
    <canvas id="background-canvas" width="300" height="300"></canvas>
    <canvas id="drawing-canvas" width="300" height="300"></canvas>
</div>

<div class="controls">
    <label for="line-width">ì„  ë‘ê»˜: </label>
    <input type="range" id="line-width" min="1" max="10" value="1">
    <button id="eraser">ì§€ìš°ê°œ ì¼œê¸°</button>
    <button id="allclear">ëª¨ë‘ ì§€ìš°ê¸°</button>
</div>
        
<div class="color-picker">
    <div class="color-button black selected" data-color="black"><span>&#10003;</span></div>
    <div class="color-button red" data-color="red"><span>&#10003;</span></div>
    <div class="color-button orange" data-color="orange"><span>&#10003;</span></div>
    <div class="color-button yellow" data-color="yellow"><span>&#10003;</span></div>
    <div class="color-button green" data-color="green"><span>&#10003;</span></div>
    <div class="color-button blue" data-color="blue"><span>&#10003;</span></div>
    <div class="color-button indigo" data-color="indigo"><span>&#10003;</span></div>
    <div class="color-button violet" data-color="violet"><span>&#10003;</span></div>
</div>

<div class=sticker-container>
    <img class="sticker" src="https://github.com/201960003/study_blog/blob/main/img/post25/four_leaf_clover.png?raw=true"></img>
    <img class="sticker" src="https://github.com/201960003/study_blog/blob/main/img/post25/three_leaf_clover.png?raw=true"></img>
</div>
        
<button id="save" onclick="saveCanvas()">ì €ì¥</button>

<script>
    // canvas part
    var drawingCanvas = document.getElementById("drawing-canvas"); // ì„  ê·¸ë¦¬ê¸° canvas
    var stickerBoard = document.getElementById("background-canvas"); // ìŠ¤í‹°ì»¤ ê·¸ë¦¬ê¸° canvas
    var drawingContext = drawingCanvas.getContext("2d"); // drawingCanvasì˜ context
    var backgroundContext = stickerBoard.getContext("2d"); // backgroundCanvasì˜ context

    function saveCanvas() {
        var compositeCanvas = document.createElement('canvas'); // ê·¸ë¦¼ + ì„  ìº í¼ìŠ¤ í•©ì¹˜ê¸° ìœ„í•œ canvas ìƒì„±
        compositeCanvas.width = backgroundCanvas.width;
        compositeCanvas.height = backgroundCanvas.height;
        var compositeContext = compositeCanvas.getContext('2d'); //  compositeCanvasì˜ context ìƒì„±

        // ë°°ê²½ ìº”ë²„ìŠ¤ì™€ ë“œë¡œì‰ ìº”ë²„ìŠ¤ë¥¼ í•©ì¹¨
        compositeContext.drawImage(backgroundCanvas, 0, 0);
        compositeContext.drawImage(drawingCanvas, 0, 0);

        // í•©ì¹œ ìº”ë²„ìŠ¤ë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜í•˜ì—¬ ë‹¤ìš´ë¡œë“œ
        var dataURL = compositeCanvas.toDataURL('image/png');
        var link = document.createElement('a');
        link.href = dataURL;
        link.download = `${getCurrentDateTimeString()}.png`;
        link.click();
    }

    function getCurrentDateTimeString() {
        var today = new Date();
        var year = today.getFullYear();
        var month = String(today.getMonth() + 1).padStart(2, '0');
        var day = String(today.getDate()).padStart(2, '0');
        var hours = String(today.getHours()).padStart(2, '0');
        var minutes = String(today.getMinutes()).padStart(2, '0');
        var seconds = String(today.getSeconds()).padStart(2, '0');

        // Return formatted date and time string
        return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
    }

    // line-controller part
    var lastX = 0; // ë§ˆì§€ë§‰ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ x ê°’
    var lastY = 0; // ë§ˆì§€ë§‰ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ y ê°’
    var isDrawing = false; // ê·¸ë¦¬ê¸° ìƒíƒœ, false : ì•ˆê·¸ë¦¬ê¸°
    var strokeStyle = 'black';  // ê¸°ë³¸ ì„  ìƒ‰ìƒ
    var lineWidth = 1; // ê¸°ë³¸ ì„  ë‘ê»˜
    var lineCap = "round";  // ê¸°ë³¸ ì„  ëª¨ì–‘
    var isErasing = false;  // ì§€ìš°ê°œ ëª¨ë“œ ì—¬ë¶€


    function handleMouseDown(event) {
        // ë§ˆìš°ìŠ¤ í´ë¦­í–ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
        isDrawing = true;
        [lastX, lastY] = [event.offsetX, event.offsetY];
        // í˜„ì¬ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ì¸ [event.offsetX, event.offsetY] ë¥¼ ê°ê° lastX, lastY ì— ì €ì¥
    };


    function handleMouseMove(event) {
        // ë§ˆìš°ìŠ¤ê°€ canvas íƒœê·¸ë‚´ì—ì„œ ì›€ì§ì˜€ì„ ë•Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
        if (!isDrawing) return;  // isDrawingì´ falseì¼ ë•ŒëŠ” returnìœ¼ë¡œ í•¨ìˆ˜ë¥¼ ì¢…ë£Œ
        // ë§ˆìš°ìŠ¤ê°€ ì›€ì§ì¼ ë•Œ isDrawingì´ trueì´ë©´ í˜„ì¬ ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜´
        const currentX = event.offsetX;
        const currentY = event.offsetY;

        drawingContext.lineWidth = lineWidth; // ì§€ì •í•œ ì„  ë‘ê»˜
        drawingContext.strokeStyle = strokeStyle; // ì§€ì •í•œ ì„  ìƒ‰ìƒ
        drawingContext.lineCap = lineCap; // ì§€ì •í•œ ì„  ëª¨ì–‘

        drawingContext.beginPath(); // contextì˜ ìƒˆë¡œìš´ ê²½ë¡œë¥¼ ì‹œì‘
        drawingContext.moveTo(lastX, lastY); // ë§ˆì§€ë§‰ ë§ˆìš°ìŠ¤ ìœ„ì¹˜
        drawingContext.lineTo(currentX, currentY); // moveToë¡œ ì§€ì •í•œ ì´ì „ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ì—ì„œ í˜„ì¬ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ê¹Œì§€ ì„  ê·¸ë¦¬ê¸°


        if (isErasing) {
            drawingContext.globalCompositeOperation = 'destination-out';
            drawingContext.stroke();
            drawingContext.globalCompositeOperation = 'source-over';
        } else {
            drawingContext.stroke();
        }
                
        // drawingContext.closePath(); // contextì˜ ê²½ë¡œë¥¼ ì¢…ë£Œ

        [lastX, lastY] = [currentX, currentY]; // í˜„ì¬ ìœ„ì¹˜ë¥¼ ì €ì¥
    };

    function handleMouseUp() {
        // ë§ˆìš°ìŠ¤ í´ë¦­ í•´ì œí–ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
        isDrawing = false;
    };

    function handleMouseLeave() {
        // ë§ˆìš°ìŠ¤ê°€ canvas íƒœê·¸ë¥¼ ë²—ì–´ë‚¬ì„ ë•Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
        isDrawing = false;
    };

    // ì„  ë‘ê»˜ ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.getElementById('line-width').addEventListener('input', function() {
        lineWidth = this.value;
    });

    // ì§€ìš°ê°œ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.getElementById('eraser').addEventListener('click', function() {
        isErasing = !isErasing;  // ì§€ìš°ê°œ ëª¨ë“œë¥¼ í† ê¸€
        if (isErasing) {
            this.textContent = 'ì§€ìš°ê°œ ë„ê¸°';
            // document.querySelectorAll('.color-button').forEach(btn => btn.classList.remove('selected'));  // ëª¨ë“  ìƒ‰ìƒ ë²„íŠ¼ ì„ íƒ í•´ì œ
        } else {
            this.textContent = 'ì§€ìš°ê°œ ì¼œê¸°';
        }
    });

    document.querySelectorAll('.color-button').forEach(button => {
        button.addEventListener('click', function() {
            document.querySelectorAll('.color-button').forEach(btn => btn.classList.remove('selected')); // ê¸°ì¡´ì— ì²´í¬ë˜ì—ˆë˜ ìƒ‰ìƒì€ í•´ì œ
            this.classList.add('selected'); // ì„ íƒí•œê±´ ì²´í¬í‘œì‹œ ë‚˜ì˜¤ê²Œ
            strokeStyle = this.getAttribute('data-color'); // data-color ì†ì„±ê°’ìœ¼ë¡œ ì§€ì •í•œ ì„¹ìƒë³€ê²½
            isErasing = false;  // ì§€ìš°ê°œ ëª¨ë“œë¥¼ í•´ì œ
        });
    });

    // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
    drawingCanvas.addEventListener('mousedown', handleMouseDown);
    drawingCanvas.addEventListener('mousemove', handleMouseMove);
    drawingCanvas.addEventListener('mouseup', handleMouseUp);
    drawingCanvas.addEventListener('mouseleave', handleMouseLeave);

    // í„°ì¹˜ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    drawingCanvas.addEventListener('touchstart', ()=>{
        handleMouseDown
        console.log("ddjdjdjdj")
    });
    drawingCanvas.addEventListener('touchmove', handleMouseMove);
    drawingCanvas.addEventListener('touchend', handleMouseUp);
    drawingCanvas.addEventListener('touchcancel',handleMouseLeave);

    document.getElementById('allclear').addEventListener('click', function() {
        drawingContext.clearRect(0, 0, drawingCanvas.width, drawingCanvas.height);
    }); // ëª¨ë‘ ì§€ìš°ê¸°

    // ìŠ¤í‹°ì»¤ ì»¨í…Œì´ë„ˆ
    const stickers = document.querySelectorAll('.sticker img');
    stickers.forEach(sticker => {
        sticker.addEventListener('click', onClick);
        sticker.addEventListener('touchstart', onClick, { passive: false });
    });

    stickerBoard.addEventListener('dragover', onDragOver);
    stickerBoard.addEventListener('drop', onDrop);
    stickerBoard.addEventListener('touchstart', onTouchStart, { passive: false });
    stickerBoard.addEventListener('touchmove', onTouchMove, { passive: false });
    stickerBoard.addEventListener('touchend', onTouchEnd);

    function onClick(e) {
        e.preventDefault();
        const rect = stickerBoard.getBoundingClientRect();
            const centerX = rect.width / 2;
            const centerY = rect.height / 2;

            draggedSticker = e.target;

            placeSticker(centerX, centerY);
        }

        function onDragOver(e) {
            e.preventDefault();
        }

        function onDrop(e) {
            e.preventDefault();
            const rect = stickerBoard.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            placeSticker(x, y);
        }

        function onTouchMove(e) {
            if (draggedSticker && stickerBoard.contains(draggedSticker)) {
                if (e.touches.length === 2) {
                    e.preventDefault();  // ê¸°ë³¸ í„°ì¹˜ ë™ì‘ ë°©ì§€ (ì¤Œ ë“±)

                    const currentDistance = getDistance(e.touches[0], e.touches[1]);
                    const currentAngle = getAngle(e.touches[0], e.touches[1]);
                    const scale = currentDistance / initialDistance;
                    draggedSticker.style.transform = `scale(${scale}) rotate(${currentAngle}deg)`;


                } else if (e.touches.length === 1) {
                    // ë“œë˜ê·¸ ì²˜ë¦¬
                    e.preventDefault();
                    const touch = e.touches[0];
                    const rect = stickerBoard.getBoundingClientRect();
                    const x = touch.clientX - rect.left - 50;
                    const y = touch.clientY - rect.top - 50;

                    if (y > rect.height * 0.6) {
                        showTrashBin(true);
                    } else {
                        showTrashBin(false);
                    }

                    updateStickerPosition(x, y);

                }

            }
        }

        function getDistance(touch1, touch2) {
            const dx = touch1.clientX - touch2.clientX;
            const dy = touch1.clientY - touch2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }

        function getAngle(touch1, touch2) {
            const dx = touch1.clientX - touch2.clientX;
            const dy = touch1.clientY - touch2.clientY;
            return Math.atan2(dy, dx) * (180 / Math.PI);
        }

        function updateStickerPosition(x, y) {
            if (!draggedSticker) return;

            const stickerBoardRect = stickerBoard.getBoundingClientRect();
            const stickerWidth = draggedSticker.offsetWidth;
            const stickerHeight = draggedSticker.offsetHeight;

            let newX = Math.max(0, Math.min(x, stickerBoardRect.width));
            let newY = Math.max(0, Math.min(y, stickerBoardRect.height));

            draggedSticker.style.left = `${newX}px`;
            draggedSticker.style.top = `${newY}px`;
        }



        function onTouchEnd(e) {
            e.preventDefault();
            const touch = e.changedTouches[0];
            const rect = stickerBoard.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;

            if (isOverTrashBin(x, y)) {
                deleteSticker(draggedSticker);
            }
            showTrashBin(false);
            draggedSticker = null;
        }



        function placeSticker(x, y) {
            if (!draggedSticker) return;

            const stickerWidth = draggedSticker.offsetWidth;
            const stickerHeight = draggedSticker.offsetHeight;
            const newX = x - stickerWidth / 2;
            const newY = y - stickerHeight / 2;

            const rotation = draggedSticker.dataset.rotation || 0;

            if (draggedSticker.parentElement === stickerBoard) {
                // ì´ë¯¸ ìŠ¤í‹°ì»¤ë³´ë“œì— ìˆëŠ” ê²½ìš° ìœ„ì¹˜ë§Œ ì—…ë°ì´íŠ¸
                draggedSticker.style.left = newX + 'px';
                draggedSticker.style.top = newY + 'px';
                draggedSticker.style.transform = `rotate(${rotation}deg)`;
            } else {
                // ìŠ¤í‹°ì»¤ë³´ë“œì— ìƒˆë¡œ ì¶”ê°€í•  ê²½ìš°
                const newSticker = document.createElement('img');
                newSticker.src = draggedSticker.src;
                newSticker.style.position = 'absolute';
                newSticker.style.left = newX + 'px';
                newSticker.style.top = newY + 'px';
                newSticker.style.width = "100px";
                newSticker.style.height = "100px";
                newSticker.draggable = true;

                newSticker.addEventListener('dragstart', onDragStart);
                newSticker.addEventListener('touchstart', onTouchStart, { passive: false });

                stickerBoard.appendChild(newSticker);
            }
            draggedSticker = null;
        }

        function onDragStart(e) {
            draggedSticker = e.target;
            e.dataTransfer.setData('text/plain', null);
        }

        function onTouchStart(e) {
            if (e.touches.length === 1) {
                const touch = e.touches[0];
                const target = touch.target;

                if (target.tagName.toLowerCase() === 'img' && stickerBoard.contains(target)) {
                    draggedSticker = target;

                    const rect = draggedSticker.getBoundingClientRect();
                    offsetX = touch.clientX - rect.left;
                    offsetY = touch.clientY - rect.top;
                }
            } else if (e.touches.length === 2) {
                // ë‘ ì†ê°€ë½ í„°ì¹˜ - í¬ê¸° ë° ê°ë„ ì¡°ì ˆ ì‹œì‘
                initialDistance = getDistance(e.touches[0], e.touches[1]);
                initialAngle = getAngle(e.touches[0], e.touches[1]);
            }
        }


        function showTrashBin(show) {
            if (show) {
                trashBin.classList.add('visible');
            } else {
                trashBin.classList.remove('visible');
            }
        }


        function checkForTrashBinHover(x, y) {
            const rect = stickerBoard.getBoundingClientRect();
            const stickerX = x - rect.left;
            const stickerY = y - rect.top;

            if (isOverTrashBin(stickerX, stickerY)) {
                trashBin.style.backgroundColor = 'red';
            } else {
                trashBin.style.backgroundColor = 'gray';
            }
        }

        function isOverTrashBin(x, y) {
            const trashRect = trashBin.getBoundingClientRect();
            const stickerBoardRect = stickerBoard.getBoundingClientRect();

            // Trash binì˜ ì¢Œí‘œë¥¼ ìŠ¤í‹°ì»¤ ë³´ë“œ ì¢Œí‘œë¡œ ë³€í™˜
            const trashBinLeft = trashRect.left - stickerBoardRect.left;
            const trashBinTop = trashRect.top - stickerBoardRect.top;

            return (
                x >= trashBinLeft &&
                x <= trashBinLeft + trashRect.width &&
                y >= trashBinTop &&
                y <= trashBinTop + trashRect.height
            );
        }



        function deleteSticker(sticker) {
            if (sticker && sticker.parentNode) {
                sticker.parentNode.removeChild(sticker);
            }
        }


</script>


<!-- <br><br> -->

### ğŸ§ ì˜¤ëŠ˜ì˜ ì†Œê°ì€?
ìµœì¢…ì ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ í”„ë¡œì íŠ¸ í´ë” ì•ˆì— public í´ë” ì•ˆì— ì§ì ‘ ì‚¬ì§„ì„ ë„£ì–´ì„œ ì‘ì—…ì„ í•œ ë¶€ë¶„ì´ ì•„ì‰½ê¸´ í•˜ì§€ë§Œ ê·¸ë˜ë„ ì´ ì½”ë“œ ì´í›„ì— í™•ì¥ì„±ì´ ì¢‹ë‹¤ê³  ìƒê°ì„ í•˜ê¸° ë–„ë¬¸ì— ì‚´ì§ ë¿Œë“¯... í•¨ì´ ìˆê¸´ í•©ë‹ˆë‹¤. ìµœê·¼ í”ŒëŸ¬í„°ë¡œ ì‘ì—…ì„ í•˜ë‹¤ê°€ ì´ë ‡ê²Œ ì›¹ìœ¼ë¥´ ì¡°ê¸ˆ ë‹¤ë£¨ë‹ˆê¹Œ ì‚´ì§ ì¬ë¯¸ìˆì–´ì§„ ê²ƒ ê°™ì•„ìš”. ìš”ì¦˜ ì•„ì§ ê°„ë‹¨í•œê²ƒë§Œ í•˜ëŠ”ë° ê·¸ë˜ë„ ì ì  ì–´ë ¤ìš´ ê²ƒë„ í•´ë‚´ëŠ” ì•„ê¸° ê°œë°œìê°€ ë˜ê³  ì‹¶ì–´ìš”!! ì—´ì‹¬íˆ ë¹ ìƒ¤ë¹ ìƒ¤

<br>